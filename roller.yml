#
version: "0.0.1"
# Флаг атомарности
# В данном случае, распространяется на весь манифест
# Если что-либо завершено неуспешно в этом манифесте, 
# то весь манифест будет откатан до первоначалього состояния
atomic: false
# Главная и начальная структура
stage:
# Уникальное имя этапа
# На него можно будет ссылаться при указании зависимостей
# Не должен содержать пробелы или кирилицу 
- name: MDM 
  # Подробное описание действия
  # В данном случае, описание этапа
  desc: "Установка группы мдм" 
  # Флаг атомарности
  # В данном случае, распространяется на весь этап
  # Если что-либо завершено неуспешно в этом этапе, 
  # то весь этап будет откатан до первоначалього состояния
  atomic: false
  pre_check: 
    # Если в чеке используется сторонний плагин, 
    # то его нужно указать явно с помощью 'plugin:' и его названия
    plugin: 'sh_plugin'
    location: # Описаниен местодействия
      host: "192.168.1.222"
      port: 22
      user: "warki"
      password: "1604"
    action:
      bash:
        command: "ls -asl /"
  # Начало описания шагов
  stage:  
  - name: Adapter # Уникальное имя шага
    desc: "Установка адаптера"  
    atomic: false # Флаг атомарности обновления
    pre_check: 
      plugin: 'ssh_plugin'
      location: # Описаниен местодействия
        host: "192.168.1.222"
        port: 22
        user: "warki"
        password: "1604"
      action:
        bash:
          command: "ls -asl /etc"
    task:
      plugin: 'ssh_plugin'
      location: # Описаниен местодействия
        host: "192.168.1.222"
        port: 22
        user: "warki"
        password: "1604"
      action:
        bash:
          command: "ls -asl /home"
    post_check: 
      bash:
        run: "cd /etc"